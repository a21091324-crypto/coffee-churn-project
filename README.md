\# Coffee Churn Prediction



Модель бинарной классификации для прогнозирования оттока клиентов кофейного сервиса.





\## Цель проекта



Разработать модель, способную прогнозировать вероятность ухода клиента в следующем месяце.



Основная метрика качества  \*\*Precision-Recall AUC (PR-AUC)\*\*, поскольку задача характеризуется дисбалансом классов и важно корректно выявлять уходящих клиентов.





\## Результаты



| Этап | PR-AUC |

|------|--------|

| Базовая модель | 0.656 |

| После feature engineering | 0.691 |

| После подбора гиперпараметров | 0.711 |

| Финальная модель (test) | \*\*0.731\*\* |



Модель последовательно улучшалась на каждом этапе разработки.



\## Используемая модель



\*\*LogisticRegression\*\*



Лучшие гиперпараметры:

\- penalty = `l1`

\- solver = `liblinear`

\- C = `0.1`

\- class\_weight = `None`



L1-регуляризация позволила автоматически занулить менее значимые коэффициенты и повысить устойчивость модели.





\## Feature Engineering



Были добавлены нелинейные признаки:



\- логарифмы финансовых показателей

\- квадрат частоты заказов

\- квадратный корень активности пользователя



Наиболее значимые факторы:

\- количество сбоев приложения

\- активность пользователя

\- поведенческие характеристики



\## Архитектура пайплайна



Pipeline включает:



1\. Feature engineering (FunctionTransformer)

2\. Импутацию пропусков

3\. Масштабирование числовых признаков

4\. One-Hot Encoding категориальных признаков

5\. LogisticRegression



Весь пайплайн сохранён целиком для корректной работы в продакшене.





\## Сохранение модели



Финальный пайплайн сохранён с использованием `joblib`.



Файл: coffee\_churn\_model.joblib





После загрузки модель воспроизводит те же результаты на тестовой выборке.





\## Установка зависимостей



pip install -r requirements.txt

